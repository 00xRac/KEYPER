<!DOCTYPE html>
<html lang="{{ locale }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}{{ _('KEYPER') }}{% endblock %}</title>

  <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">

  <link rel="stylesheet" href="{{ url_for('static', filename='css/stylesheet.css') }}">

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Audiowide&family=Share+Tech+Mono&display=swap" rel="stylesheet">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

  
</head>

<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="/">{{ _('KEYPER') }}</a>

      <!-- BotÃ³n menÃº mÃ³vil -->
      <button id="menu-toggle" class="menu-toggle">â˜°</button>

      <!-- MenÃº escritorio -->
      <div id="desktop-menu" class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto align-items-center">
          <li class="nav-item"><a class="nav-link text-center" href="/" title="{{ _('Dashboard') }}"><i class="bi bi-grid-fill fs-4"></i></a></li>
          <li class="nav-item"><a class="nav-link text-center" href="/checker" title="{{ _('Email Checker') }}"><i class="bi bi-envelope-fill fs-4"></i></a></li>
          <li class="nav-item"><a class="nav-link text-center" href="/generator" title="{{ _('Password Generator') }}"><i class="bi bi-key-fill fs-4"></i></a></li>
          <li class="nav-item"><a class="nav-link text-center" href="/strength" title="{{ _('Strength Check') }}"><i class="bi bi-shield-lock-fill fs-4"></i></a></li>
          <li class="nav-item"><a class="nav-link text-center" href="/statistics" title="{{ _('Statistics') }}"><i class="bi bi-bar-chart-fill fs-4"></i></a></li>
          <li class="nav-item"><a class="nav-link text-center" href="/about" title="{{ _('About') }}"><i class="bi bi-info-circle-fill fs-4"></i></a></li>

          <!-- Language dropdown -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle text-center" href="#" role="button" data-bs-toggle="dropdown" title="{{ _('Language') }}">ğŸŒ</a>
            <ul class="dropdown-menu dropdown-menu-end">
              <li>
                <a class="dropdown-item" href="{{ url_for('change_language', lang='en') }}">
                  <img src="https://flagcdn.com/16x12/gb.png" alt="English" class="me-1"> English
                </a>
              </li>
              <li>
                <a class="dropdown-item" href="{{ url_for('change_language', lang='no') }}">
                  <img src="https://flagcdn.com/16x12/no.png" alt="Norsk" class="me-1"> Norsk
                </a>
              </li>
            </ul>
          </li>
        </ul>
      </div>

      <!-- MenÃº hamburguesa mÃ³vil -->
      <div id="dropdown-menu" class="dropdown-menu-custom">
        <a href="/" class="dropdown-item-custom">{{ _('Dashboard') }}</a>
        <a href="/checker" class="dropdown-item-custom">{{ _('Email Checker') }}</a>
        <a href="/generator" class="dropdown-item-custom">{{ _('Password Generator') }}</a>
        <a href="/strength" class="dropdown-item-custom">{{ _('Strength Check') }}</a>
        <a href="/statistics" class="dropdown-item-custom">{{ _('Statistics') }}</a>
        <a href="/about" class="dropdown-item-custom">{{ _('About') }}</a>
      </div>
    </div>
  </nav>

  <!-- TÃ­tulo animado con hitbox -->
  <div id="title-container">
    <div id="title"><span></span></div>
  </div>

  <!-- Fondo Matrix -->
  <canvas id="bgCanvas"></canvas>

  <!-- Contenido de pÃ¡gina -->
  <div class="container">
    {% block content %}{% endblock %}
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    /* =============================== */
    /* MenÃº hamburguesa mÃ³vil */
    /* =============================== */
    const menuToggle = document.getElementById('menu-toggle');
    const dropdownMenu = document.getElementById('dropdown-menu');

    menuToggle.addEventListener('click', () => {
      dropdownMenu.classList.toggle('show');
    });

    window.addEventListener('click', (e) => {
      if (!menuToggle.contains(e.target) && !dropdownMenu.contains(e.target)) {
        dropdownMenu.classList.remove('show');
      }
    });

    /* =============================== */
    /* Fondo Matrix */
    /* =============================== */
    const canvas = document.getElementById('bgCanvas');
    const ctx = canvas.getContext('2d');
    let width = canvas.width = window.innerWidth;
    let height = canvas.height = window.innerHeight;
    let columns = Math.floor(width / 20);
    let drops = Array(columns).fill(1);

    function drawMatrixRain() {
    const emojis = ['ğŸµï¸','ğŸ¥€','ğŸŒº','ğŸŒ¹','ğŸŒ¸','ğŸŒ·','ğŸ’','ğŸ’®','ğŸŒ»','ğŸŒ¼','ğŸ€'];

    ctx.fillStyle = 'rgba(0,0,0,0.1)';
    ctx.fillRect(0, 0, width, height);
    ctx.fillStyle = '#00ffff';
    ctx.font = '18px "Share Tech Mono", monospace';
    
    for (let i = 0; i < drops.length; i++) {
        // Elegir un emoji aleatorio de la lista
        const text = emojis[Math.floor(Math.random() * emojis.length)];
        ctx.fillText(text, i * 20, drops[i] * 20);

        // Reiniciar la gota si llega al final
        if (drops[i] * 20 > height && Math.random() > 0.975) drops[i] = 0;
        drops[i]++;
    }
}


    function animate() {
      drawMatrixRain();
      requestAnimationFrame(animate);
    }
    animate();

    window.addEventListener('resize', () => {
      width = canvas.width = window.innerWidth;
      height = canvas.height = window.innerHeight;
      columns = Math.floor(width / 20);
      drops = Array(columns).fill(1);
    });

    /* =============================== */
    /* TÃ­tulo animado */
    /* =============================== */
    const targetText = 'KEYPER';
    const titleSpan = document.querySelector('#title span');
    let iteration = 0;
    const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';

    titleSpan.style.color = '#00ffff';
    titleSpan.style.filter = 'blur(2px)';

    const interval = setInterval(() => {
      titleSpan.textContent = targetText.split('').map((letter, i) => {
        if (i < iteration) return targetText[i];
        return letters[Math.floor(Math.random() * letters.length)];
      }).join('');
      iteration += 0.2;

      if (iteration >= targetText.length) {
        titleSpan.textContent = targetText;
        titleSpan.style.transition = 'text-shadow 1s ease';
        titleSpan.style.textShadow = '0 0 20px #00ffff, 0 0 40px #00ffff, 0 0 60px #00ffff';
        titleSpan.style.filter = 'blur(0px)';
        clearInterval(interval);
      }
    }, 50);
  </script>
</body>
</html>
